#partie 1

#exo 1

#jeu 1
A<-floor(runif(1000,1,7))
barplot(table(A))
mean(A) #la moyenne
var(A)#la variance

#jeu 2
B1<-floor(runif(10000,1,7))
B2<-floor(runif(10000,1,7))
A<-(B2+B1)/2
barplot(table(A))
(mean(B1)+mean(B2))/2 
(var(B1)+var(B2))/2

#jeu 3
c1<-floor(runif(10000,1,7))
c2<-floor(runif(10000,1,7))
c3<-floor(runif(100000,1,7))
A<-(c1+c2+c3)/3
barplot(table(A))
(mean(c1)+mean(c2)+mean(c3))/3
(var(c1)+var(c2)+var(c3))/3

#exo 2

x<-rep(1:10000)
for ( i in  1:10000){
  x[i] <- mean(rpois(1000,2))
}
barplot(table(x))
hist(x,100)


#tp3

#exo 3

x<-c(50.34,52.62,53.79,54.99,55.82,57.67,51.41,53.13,53.89,55.04,55.04,55.91,57.99,51.51,53.28,54.63,55.12,55.95,58.10,52.07,53.30,54.76,55.24,57.05,59.30,52.22,53.32,54.78,55.28,57.18,60.58,52.38,53.39,54.93,55.56,57.31,63.15)
mean(x)
var(x)
t.test(x,conf.level = 0.98, mu=56 )

#partie 2

#exo 1

x<-rep(1:2)
y<-rep(1:2)
x[1]<-342
x[2]<-258
y[1]<-158
y[2]<-242

final<-rbind(x,y)
chisq.test(final)
final

#exo 2

controle<-rep(1:2)
X<-rep(1:2)
controle[1]<-17
controle[2]<-29
X[1]<-7
X[2]<-38
final<-rbind(controle,X)
final
chisq.test(final) #on rejette car c'est plus petit que 0.5 (on parle de p-value)


#exo 3

homme<-rep(1:2)
femme<-rep(1:2)
homme[1]<-414
homme[2]<-386
femme[1]<-532
femme[2]<-368
final<-rbind(homme,femme)
chisq.test(final) #hypothése les hommes regarde plus leur e-mail que les femmes
#hypothése rejetter car p-value =0.0026 donc < 0.5 on ne suppose pas l'indépendance
#on ne suppose pas l'indépendance
#exo 4

produit1<-rep(1:3)
produit2<-rep(1:3)
produit1[1]<-180
produit1[2]<-110
produit1[3]<-52
produit2[1]<-120
produit2[2]<-150
produit2[3]<-40
final<-rbind(produit1,produit2)
chisq.test(final)
final

#Regression linéaire 

X1=c( 2.1, 2.0, 4.8, 4.3, 1.4, 2.2, 3.9, 1.9, 1.2, 2.7, 2.8, 1.4, 4.6, 4.8, 3.5, 2.4, 3.2, 1.3, 0.4,
      2.2, 3.1, 0.7, 2.8, 4.8, 3.3, 2.8, 0.2, 1.4, 4.9, 2.4, 3.7, 3.5, 3.2, 0.7, 1.5, 5.0, 0.3, 3.7,
      0.2, 2.3, 1.7, 3.7, 4.0, 1.6, 1.1, 2.3, 3.5, 3.8, 3.8, 1.1)

Y1=c(67, 68, 60, 61, 70, 66, 64, 67, 68, 67, 64, 69, 61, 60, 65, 67, 65, 70, 71, 69, 64, 69, 65, 61, 66,
     64, 70, 71, 60, 67, 63, 63, 65, 72, 69, 60, 69, 60, 69, 65, 65, 62, 64, 66, 68, 65, 65, 61, 65, 72)

X2=c(3.83, 0.68, 1.82, 1.17, 2.05, 0.01, 0.04, 4.87, 2.61, 4.32, 3.82, 2.70, 2.38, 1.75, 1.48,
     0.28, 0.17, 0.28, 0.26, 4.59, 0.40, 0.11, 4.66, 4.65, 3.65, 2.01, 3.93, 0.89, 4.06, 3.18,
     1.36, 3.49, 3.29, 2.18, 0.10, 2.24, 4.69, 0.75, 0.86, 2.23, 1.71, 2.09, 0.51, 4.16, 1.53,
     4.44, 1.35, 0.50, 0.99, 1.65)
Y2=c(3.6, 2.9, 3.0, 4.3, 7.2, 3.2, 1.4, 7.5, 8.1, 5.8, 3.5, 4.9, 2.2, 5.4, 3.5, 2.2, 2.8, 2.2, 3.2,
     6.2, 6.8, 1.5, 5.0, 1.4, 3.5, 4.8, 3.6, 3.4, 5.6, 3.6, 3.2, 4.4, 8.3, 2.7, 5.6, 5.8, 6.9, 3.2,
     3.2, 1.8, 6.1, 3.1, 3.8, 9.6, 3.7, 4.4, 2.9, 2.3, 5.1, 1.0)


X3=c(0.56, 3.58, 1.06, 3.13, 3.57, 3.35, 2.98, 3.73, 0.25, 2.29, 3.98, 4.11, 1.97, 1.35, 3.28,
     0.48, 3.06, 2.03, 1.68, 2.25, 3.67, 2.84, 2.94, 1.98, 1.93, 1.13, 2.77, 1.94, 0.70, 0.60,
     2.68, 1.81, 0.81, 0.05, 1.04, 3.94, 3.27, 3.13, 2.06, 0.66, 1.67, 2.67, 4.28, 2.10, 0.70,
     1.64, 1.78, 3.32, 4.40, 1.24)

Y3=c(5.8,  4.7,  6.5,  7.0,  8.7,  7.1,  5.2,  3.1,  5.1,  6.9,  4.8, 11.1,  6.3,  5.7,  3.8,
     4.3,  4.9,  8.4,  8.5,  6.5,  4.0,  6.3,  3.6,  5.5,  4.5,  3.1,  5.3,  6.5,  5.3,  4.6,
     4.2,  4.0,  6.6,  7.9,  5.9,  4.1,  4.2,  5.3,  3.9, 10.0, 12.5,  6.3,  4.8,  7.6,  7.2,
     6.2,  3.4,  8.0,  6.1,  6.8)

X4=c( 4.1, 1.1, 2.3, 3.2, 2.9, 5.2, 0.2, 4.7, 5.7, 3.5, 2.9, 1.9, 4.0, 3.8, 5.5, 3.3, 3.1, 5.7, 4.6,
      3.8, 0.3, 4.9, 3.2, 3.9, 0.4, 1.6, 1.4, 0.3, 1.9, 1.3, 1.0, 1.4, 5.8, 1.8, 0.5, 2.6, 0.5, 0.4,
      0.2, 0.3, 5.7, 2.6, 4.5, 3.9, 1.3, 4.2, 2.5, 2.6, 5.5, 4.6)

Y4=c(4.77,  2.10,  5.70,  5.93,  5.73,  1.10, -2.39,  2.92, -1.31,  5.82,  5.89,  4.62, 4.80,  5.45,
     -0.22,  5.59,  5.91, -1.41, 3.32, 5.43, -1.01, 2.03,  5.52,  5.46, -0.90,  3.93,  3.59, -1.61,  4.34, 
     3.22,  2.07,  3.10, -1.79,  4.63,  0.08,  5.96, 0.10, -0.97, -1.72, -1.54, -1.65, 6.16,  3.84,  5.53,  
     2.93,  4.25,  5.60,  5.79, -0.06,  3.64)

X5=c(7, 13, 15, 7, 6, 12, 7,  5, 11,  9, 11, 13, 14, 8, 13, 6, 10, 14, 5, 9, 10, 10, 9, 7, 6, 12, 7, 7, 8, 12)

Y5=c(16, 21, 23, 15, 10, 19, 13, 12, 16, 13, 18, 21, 19, 12, 20, 13, 17, 22, 12, 16, 16, 16, 16, 14, 10, 20, 12, 14,
     15, 7)
plot(X1,Y1)
abline(lsfit(X1,Y1))

plot(X2,Y2)
abline(lsfit(X2,Y2))

plot(X3,Y3)
abline(lsfit(X3,Y3))

plot(X4,Y4)
abline(lsfit(X4,Y4))
cor(X4,Y4)

plot(X5,Y5)
abline(lsfit(X5,Y5))
cor(X5,Y5)


#exo 1 test paramétriques, intervalles de confiance

